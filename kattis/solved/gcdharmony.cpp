#pragma GCC optimize("Ofast,unroll-loops")
#pragma GCC target("avx2,bmi,bmi2,lzcnt,popcnt")

#include <bits/stdc++.h>

using namespace std;

typedef uint8_t u8;
typedef uint16_t u16;
typedef uint32_t u32;

constexpr u16 BIG = 0x2727;
constexpr u16 NUM_SF = 1395;
constexpr array<u16, NUM_SF> SF{2, 3, 5, 6, 7, 10, 11, 13, 14, 15, 17, 19, 21, 22, 23, 26, 29, 30, 31, 33, 34, 35, 37, 38, 39, 41, 42, 43, 46, 47, 51, 53, 55, 57, 58, 59, 61, 62, 65, 66, 67, 69, 70, 71, 73, 74, 77, 78, 79, 82, 83, 85, 86, 87, 89, 91, 93, 94, 95, 97, 102, 105, 106, 110, 111, 114, 115, 118, 119, 122, 123, 129, 130, 133, 134, 138, 141, 142, 143, 145, 146, 154, 155, 158, 159, 161, 165, 166, 170, 174, 177, 178, 182, 183, 185, 186, 187, 190, 194, 195, 201, 203, 205, 209, 210, 213, 215, 217, 219, 221, 222, 230, 231, 235, 237, 238, 246, 247, 249, 253, 255, 258, 259, 265, 266, 267, 273, 282, 285, 286, 287, 290, 291, 295, 299, 301, 305, 310, 318, 319, 322, 323, 329, 330, 335, 341, 345, 354, 355, 357, 365, 366, 370, 371, 374, 377, 385, 390, 391, 395, 399, 402, 403, 406, 407, 410, 413, 415, 418, 426, 427, 429, 430, 434, 435, 437, 438, 442, 445, 451, 455, 462, 465, 469, 470, 473, 474, 481, 483, 485, 493, 494, 497, 498, 506, 510, 511, 517, 518, 527, 530, 533, 534, 546, 551, 553, 555, 559, 561, 570, 574, 581, 582, 583, 589, 590, 595, 598, 602, 609, 610, 611, 615, 623, 627, 629, 638, 645, 646, 649, 651, 658, 663, 665, 667, 670, 671, 679, 682, 689, 690, 697, 703, 705, 710, 713, 714, 715, 730, 731, 737, 741, 742, 754, 759, 767, 770, 777, 779, 781, 782, 790, 793, 795, 798, 799, 803, 805, 806, 814, 817, 826, 830, 851, 854, 858, 861, 869, 870, 871, 874, 885, 890, 893, 897, 899, 901, 902, 903, 910, 913, 915, 923, 930, 935, 938, 943, 946, 949, 957, 962, 966, 969, 970, 979, 986, 987, 989, 994, 1001, 1003, 1005, 1007, 1015, 1022, 1023, 1027, 1034, 1037, 1045, 1054, 1065, 1066, 1067, 1073, 1079, 1081, 1085, 1095, 1102, 1105, 1106, 1110, 1113, 1118, 1121, 1122, 1131, 1139, 1147, 1155, 1157, 1159, 1162, 1166, 1173, 1178, 1185, 1189, 1190, 1207, 1209, 1218, 1219, 1221, 1222, 1230, 1235, 1239, 1241, 1245, 1246, 1247, 1254, 1258, 1261, 1265, 1271, 1273, 1281, 1290, 1295, 1298, 1302, 1309, 1311, 1326, 1330, 1333, 1334, 1335, 1342, 1343, 1349, 1353, 1357, 1358, 1363, 1365, 1378, 1387, 1394, 1403, 1406, 1407, 1410, 1411, 1419, 1426, 1430, 1435, 1443, 1455, 1457, 1462, 1463, 1474, 1479, 1482, 1491, 1495, 1501, 1505, 1513, 1517, 1518, 1533, 1534, 1537, 1541, 1547, 1551, 1554, 1558, 1562, 1577, 1581, 1586, 1590, 1591, 1595, 1598, 1599, 1606, 1610, 1615, 1633, 1634, 1643, 1645, 1649, 1653, 1659, 1677, 1679, 1691, 1702, 1705, 1711, 1722, 1729, 1738, 1739, 1742, 1743, 1749, 1763, 1767, 1769, 1770, 1771, 1785, 1786, 1794, 1798, 1802, 1806, 1817, 1826, 1829, 1830, 1833, 1843, 1846, 1855, 1869, 1870, 1885, 1886, 1887, 1891, 1898, 1909, 1914, 1927, 1938, 1943, 1947, 1955, 1958, 1961, 1974, 1978, 1995, 2001, 2002, 2006, 2010, 2013, 2014, 2015, 2021, 2030, 2035, 2037, 2046, 2047, 2054, 2059, 2065, 2067, 2074, 2077, 2090, 2091, 2093, 2109, 2117, 2130, 2134, 2135, 2139, 2145, 2146, 2158, 2162, 2170, 2173, 2183, 2185, 2190, 2193, 2201, 2210, 2211, 2226, 2231, 2233, 2242, 2255, 2257, 2261, 2262, 2263, 2278, 2279, 2291, 2294, 2301, 2310, 2314, 2318, 2337, 2343, 2345, 2346, 2365, 2370, 2378, 2379, 2387, 2397, 2405, 2407, 2409, 2414, 2415, 2418, 2419, 2431, 2438, 2442, 2449, 2451, 2465, 2470, 2478, 2479, 2482, 2485, 2490, 2491, 2494, 2501, 2522, 2530, 2537, 2542, 2546, 2553, 2555, 2562, 2573, 2581, 2585, 2590, 2607, 2613, 2618, 2622, 2623, 2627, 2635, 2639, 2665, 2666, 2670, 2679, 2686, 2697, 2698, 2701, 2703, 2706, 2714, 2717, 2726, 2730, 2737, 2739, 2747, 2755, 2759, 2765, 2769, 2773, 2774, 2795, 2805, 2806, 2813, 2814, 2821, 2822, 2829, 2838, 2847, 2849, 2867, 2870, 2881, 2886, 2905, 2910, 2911, 2914, 2915, 2923, 2926, 2937, 2945, 2958, 2967, 2982, 2990, 2993, 3002, 3003, 3007, 3009, 3010, 3021, 3026, 3034, 3045, 3053, 3055, 3059, 3066, 3071, 3074, 3081, 3082, 3094, 3102, 3111, 3115, 3127, 3135, 3139, 3145, 3149, 3154, 3157, 3162, 3182, 3190, 3198, 3201, 3219, 3230, 3233, 3237, 3239, 3243, 3245, 3255, 3266, 3286, 3289, 3290, 3293, 3298, 3306, 3311, 3315, 3318, 3335, 3337, 3354, 3355, 3358, 3363, 3367, 3382, 3395, 3397, 3403, 3410, 3417, 3422, 3431, 3441, 3445, 3451, 3458, 3471, 3477, 3478, 3485, 3486, 3498, 3515, 3526, 3534, 3538, 3542, 3551, 3553, 3565, 3567, 3569, 3570, 3589, 3599, 3619, 3621, 3634, 3649, 3655, 3657, 3658, 3666, 3685, 3686, 3689, 3705, 3710, 3713, 3723, 3731, 3738, 3741, 3763, 3770, 3774, 3782, 3783, 3795, 3813, 3818, 3819, 3827, 3835, 3854, 3857, 3869, 3885, 3886, 3894, 3895, 3901, 3905, 3910, 3913, 3922, 3927, 3953, 3965, 3977, 3990, 3995, 3999, 4002, 4015, 4026, 4029, 4030, 4042, 4047, 4070, 4071, 4074, 4081, 4085, 4087, 4089, 4094, 4118, 4123, 4130, 4134, 4147, 4154, 4161, 4171, 4182, 4183, 4186, 4187, 4189, 4199, 4209, 4218, 4233, 4234, 4255, 4270, 4277, 4278, 4290, 4301, 4305, 4307, 4331, 4345, 4346, 4355, 4366, 4370, 4371, 4386, 4389, 4399, 4402, 4403, 4422, 4433, 4453, 4462, 4465, 4466, 4485, 4495, 4503, 4505, 4510, 4514, 4515, 4522, 4526, 4539, 4543, 4551, 4558, 4559, 4565, 4582, 4602, 4611, 4615, 4623, 4641, 4661, 4669, 4674, 4686, 4690, 4697, 4715, 4717, 4730, 4731, 4745, 4757, 4758, 4773, 4774, 4785, 4794, 4807, 4810, 4814, 4818, 4819, 4823, 4830, 4838, 4845, 4862, 4879, 4891, 4895, 4897, 4898, 4899, 4902, 4921, 4929, 4930, 4935, 4945, 4947, 4958, 4970, 4982, 4991, 5002, 5005, 5015, 5035, 5037, 5063, 5073, 5074, 5083, 5106, 5110, 5115, 5117, 5133, 5135, 5141, 5146, 5159, 5162, 5170, 5183, 5185, 5187, 5214, 5217, 5226, 5246, 5251, 5254, 5270, 5278, 5289, 5291, 5293, 5307, 5313, 5330, 5335, 5358, 5365, 5369, 5394, 5395, 5402, 5405, 5406, 5423, 5429, 5434, 5451, 5453, 5467, 5474, 5478, 5487, 5494, 5510, 5518, 5529, 5530, 5538, 5546, 5551, 5561, 5565, 5590, 5593, 5605, 5609, 5610, 5621, 5626, 5642, 5655, 5658, 5673, 5681, 5694, 5695, 5698, 5719, 5723, 5727, 5734, 5735, 5762, 5767, 5781, 5785, 5795, 5797, 5810, 5822, 5829, 5830, 5846, 5863, 5865, 5874, 5883, 5890, 5893, 5917, 5934, 5945, 5957, 5963, 5986, 6006, 6014, 6018, 6035, 6042, 6045, 6059, 6061, 6063, 6083, 6090, 6095, 6097, 6105, 6106, 6110, 6118, 6141, 6142, 6149, 6162, 6177, 6195, 6205, 6222, 6230, 6231, 6235, 6251, 6254, 6270, 6278, 6279, 6290, 6293, 6298, 6305, 6307, 6314, 6319, 6351, 6355, 6365, 6391, 6402, 6405, 6409, 6438, 6461, 6466, 6474, 6478, 6479, 6486, 6490, 6497, 6499, 6510, 6519, 6545, 6549, 6555, 6557, 6578, 6586, 6601, 6603, 6622, 6630, 6643, 6665, 6670, 6674, 6693, 6699, 6710, 6715, 6721, 6726, 6734, 6745, 6765, 6771, 6783, 6785, 6789, 6790, 6794, 6806, 6815, 6834, 6837, 6851, 6853, 6862, 6873, 6882, 6887, 6890, 6902, 6919, 6923, 6935, 6942, 6954, 6970, 7015, 7021, 7030, 7031, 7035, 7049, 7055, 7081, 7095, 7102, 7106, 7130, 7134, 7138, 7161, 7163, 7178, 7189, 7198, 7215, 7221, 7238, 7242, 7257, 7259, 7285, 7293, 7298, 7310, 7314, 7315, 7337, 7347, 7370, 7378, 7387, 7395, 7410, 7426, 7429, 7437, 7446, 7455, 7462, 7469, 7473, 7482, 7503, 7505, 7511, 7526, 7553, 7565, 7566, 7567, 7579, 7585, 7590, 7611, 7626, 7638, 7654, 7657, 7663, 7665, 7667, 7670, 7685, 7705, 7714, 7719, 7733, 7735, 7738, 7743, 7755, 7770, 7790, 7802, 7810, 7826, 7843, 7847, 7854, 7869, 7881, 7885, 7905, 7906, 7917, 7930, 7954, 7955, 7973, 7990, 7995, 7998, 8029, 8030, 8041, 8051, 8058, 8094, 8099, 8103, 8113, 8142, 8151, 8162, 8165, 8170, 8174, 8177, 8178, 8211, 8215, 8241, 8245, 8246, 8265, 8277, 8294, 8295, 8319, 8322, 8323, 8342, 8366, 8374, 8378, 8385, 8395, 8398, 8418, 8437, 8439, 8449, 8455, 8463, 8466, 8510, 8533, 8547, 8554, 8555, 8569, 8601, 8602, 8610, 8614, 8633, 8643, 8645, 8662, 8671, 8687, 8690, 8695, 8710, 8715, 8723, 8729, 8733, 8742, 8745, 8769, 8778, 8789, 8798, 8806, 8815, 8827, 8835, 8845, 8855, 8866, 8897, 8906, 8911, 8930, 8970, 8979, 8987, 8990, 9006, 9010, 9021, 9030, 9061, 9078, 9085, 9086, 9102, 9118, 9130, 9139, 9145, 9159, 9165, 9177, 9213, 9215, 9222, 9230, 9246, 9269, 9282, 9322, 9331, 9338, 9345, 9361, 9367, 9381, 9394, 9401, 9417, 9430, 9434, 9435, 9443, 9447, 9455, 9462, 9471, 9490, 9499, 9503, 9514, 9541, 9545, 9546, 9570, 9581, 9614, 9635, 9638, 9646, 9690, 9699, 9709, 9715, 9717, 9735, 9758, 9782, 9790, 9794, 9798, 9805, 9821, 9823, 9842, 9858, 9867, 9870, 9877, 9879, 9889, 9890, 9894, 9911, 9933, 9982};
constexpr array<u32, NUM_SF> SFPF{1, 2, 4, 3, 8, 5, 16, 32, 9, 6, 64, 128, 10, 17, 256, 33, 512, 7, 1024, 18, 65, 12, 2048, 129, 34, 4096, 11, 8192, 257, 16384, 66, 32768, 20, 130, 513, 65536, 131072, 1025, 36, 19, 262144, 258, 13, 524288, 1048576, 2049, 24, 35, 2097152, 4097, 4194304, 68, 8193, 514, 8388608, 40, 1026, 16385, 132, 16777216, 67, 14, 32769, 21, 2050, 131, 260, 65537, 72, 131073, 4098, 8194, 37, 136, 262145, 259, 16386, 524289, 48, 516, 1048577, 25, 1028, 2097153, 32770, 264, 22, 4194305, 69, 515, 65538, 8388609, 41, 131074, 2052, 1027, 80, 133, 16777217, 38, 262146, 520, 4100, 144, 15, 524290, 8196, 1032, 1048578, 96, 2051, 261, 26, 16388, 2097154, 73, 4099, 160, 4194306, 272, 70, 8195, 2056, 32772, 137, 8388610, 42, 16387, 134, 49, 4104, 517, 16777218, 65540, 288, 8200, 131076, 1029, 32771, 528, 265, 192, 16392, 23, 262148, 1040, 262, 65539, 524292, 74, 1048580, 131075, 2053, 32776, 81, 544, 28, 39, 320, 2097156, 138, 262147, 1056, 521, 2064, 4101, 65544, 4194308, 145, 524291, 131080, 50, 8197, 1033, 518, 384, 1048579, 97, 8388612, 4112, 44, 27, 1030, 262152, 16389, 8208, 2097155, 2080, 266, 16777220, 576, 161, 524296, 4194307, 273, 71, 1048584, 16400, 2057, 1088, 32773, 4128, 8388611, 43, 640, 2097160, 2054, 8224, 82, 135, 4105, 4194312, 16777219, 32784, 1152, 65541, 76, 289, 8201, 522, 131077, 16416, 4102, 8388616, 146, 2112, 529, 8198, 193, 65552, 1034, 16393, 98, 140, 768, 262149, 131088, 16777224, 1041, 32800, 263, 4160, 2176, 16390, 524293, 1280, 75, 52, 1048581, 8256, 262160, 162, 32777, 545, 274, 65568, 29, 2058, 4224, 524304, 321, 2097157, 131104, 32774, 139, 16448, 1048592, 268, 1057, 2065, 8320, 65545, 4194309, 2304, 131081, 51, 4106, 2097168, 519, 262176, 385, 65542, 8388613, 16512, 290, 1536, 32832, 4113, 8202, 45, 4194320, 131078, 524320, 1031, 84, 262153, 4352, 8209, 1048608, 530, 2081, 267, 194, 16777221, 8388624, 577, 16394, 8448, 524297, 56, 65600, 262150, 32896, 524, 1048585, 1042, 2097184, 16401, 131136, 148, 1089, 524294, 4129, 16777232, 2560, 4194336, 16640, 1036, 1048582, 641, 100, 2097161, 2055, 32778, 8225, 65664, 83, 546, 262208, 3072, 30, 8388640, 131200, 4194313, 32785, 322, 1153, 2097158, 4608, 77, 524352, 1058, 523, 33024, 2066, 16417, 4103, 164, 65546, 1048640, 4194310, 8388617, 8704, 147, 2113, 16777248, 276, 5120, 262272, 131082, 8199, 2060, 65553, 1035, 88, 386, 99, 141, 9216, 769, 8388614, 131089, 2097216, 524416, 4114, 65792, 16777225, 16896, 46, 32801, 1048704, 4161, 131328, 2177, 262154, 16391, 4194368, 8210, 1281, 53, 4108, 2082, 16777222, 17408, 8257, 152, 262161, 578, 163, 524298, 292, 2097280, 8204, 8388672, 6144, 275, 1048586, 65569, 33280, 262400, 104, 16402, 2059, 4225, 524305, 4194432, 1090, 131105, 32775, 10240, 532, 16449, 4130, 1048593, 269, 196, 524544, 8321, 33792, 16396, 16777280, 642, 2097162, 8226, 1048832, 8388736, 2305, 1044, 66048, 4107, 168, 2097169, 18432, 262177, 4194314, 32786, 12288, 1154, 131584, 65543, 280, 78, 16513, 291, 1537, 32833, 8203, 2097408, 4194321, 66560, 131079, 16418, 16777344, 524321, 32780, 8388618, 85, 548, 4353, 2114, 132096, 1048609, 4194560, 531, 20480, 195, 262656, 65554, 324, 8388625, 34816, 16395, 8449, 142, 770, 57, 65601, 262151, 131090, 32897, 1060, 24576, 525, 2068, 16777226, 1043, 8388864, 2097185, 524800, 65548, 32802, 131137, 263168, 149, 4162, 296, 2178, 1049088, 524295, 16777233, 131084, 1282, 54, 2561, 4194337, 16641, 1037, 36864, 67584, 388, 1048583, 8258, 525312, 101, 262162, 32779, 16777472, 536, 65665, 4116, 133120, 200, 547, 1049600, 262209, 40960, 2097664, 3073, 65570, 31, 8388641, 131201, 4226, 524306, 262156, 323, 8212, 2097159, 4609, 131106, 1048, 16450, 2084, 4194816, 1048594, 524353, 270, 1059, 69632, 112, 33025, 2067, 2098176, 8322, 580, 165, 65547, 264192, 1048641, 524300, 4194311, 49152, 8705, 135168, 16777249, 277, 73728, 5121, 262273, 2306, 1048588, 131083, 4195328, 8389120, 16404, 2061, 2097170, 262178, 89, 387, 139264, 526336, 1092, 552, 4132, 9217, 8388615, 16514, 2097217, 1538, 524417, 1050624, 32834, 4115, 65793, 176, 16897, 47, 328, 4194322, 266240, 644, 8389632, 2097164, 524322, 81920, 1048705, 8228, 86, 131329, 16777728, 262155, 1064, 4194369, 4354, 8211, 1048610, 2072, 147456, 4109, 270336, 2083, 4194316, 16777223, 528384, 17409, 32788, 2099200, 153, 8388626, 1156, 579, 8450, 524299, 293, 1052672, 2097281, 58, 16778240, 65602, 8205, 32898, 8388673, 6145, 526, 532480, 16420, 392, 1048587, 4196352, 33281, 2097186, 262401, 105, 16403, 131138, 8388620, 98304, 150, 1056768, 2116, 278528, 4194433, 4120, 1091, 10241, 533, 4131, 16777234, 2562, 197, 163840, 4194338, 2101248, 16642, 65556, 1038, 524545, 33793, 304, 16397, 8390656, 16777281, 643, 8216, 102, 2097163, 772, 540672, 8227, 131092, 1048833, 65666, 2088, 8388737, 16777228, 2105344, 4198400, 1045, 262210, 66049, 1064960, 3074, 32804, 584, 169, 8388642, 131202, 18433, 4164, 4194315, 32787, 2180, 12289, 1155, 131585, 281, 294912, 208, 1284, 4610, 4202496, 79, 16779264, 196608, 16408, 524354, 2097409, 8392704, 8260, 33026, 66561, 16419, 262164, 16777345, 1096, 166, 32781, 2113536, 1048642, 4136, 8388619, 8706, 557056, 549, 2115, 132097, 16777250, 278, 5122, 4194561, 262274, 8396800, 65572, 20481, 648, 1081344, 2062, 262657, 65555, 4228, 4210688, 524308, 325, 8232, 34817, 90, 327680, 131108, 16781312, 143, 16452, 9218, 771, 1048596, 131091, 2097218, 1061, 24577, 524418, 2069, 65794, 16777227, 32792, 8324, 393216, 16898, 8388865, 524801, 1160, 65549, 32803, 560, 263169, 1048706, 16785408, 4163, 8404992, 297, 2129920, 589824, 224, 131330, 2179, 4194370, 1049089, 2308, 131085, 16424, 1283, 55, 336, 4110, 1114112, 655360, 2097172, 36865, 262180, 67585, 389, 17410, 8259, 154, 4227072, 525313, 2120, 262163, 1072, 1179648, 16777473, 16516, 537, 294, 1540, 2097282, 32836, 4117, 133121, 8206, 201, 1049601, 8388674, 65560, 6146, 40961, 16793600, 4194324, 2097665, 65571, 33282, 524324, 262402, 106, 2162688, 776, 4227, 524307, 262157, 131096, 4356, 8421376, 8213, 4194434, 1048612, 786432, 131107, 10242, 1049, 534, 16451, 400, 2085, 4194817, 1048595, 2228224, 32808, 271, 69633, 198, 113, 4168, 1310720, 8388628, 4259840, 2098177, 524546, 8323, 2184, 33794, 581, 16398, 8452, 16777282, 264193, 524301, 49153, 1288, 135169, 60, 65604, 32900, 1048834, 4325376, 8388738, 73729, 352, 2307, 1048589, 1046, 8264, 66050, 2097188, 16809984, 4195329, 262168, 8389121, 16405, 1572864, 131140, 170, 2097171, 18434, 262179, 139265, 8454144, 526337, 1093, 553, 12290, 2096, 2359296, 131586, 282, 4133, 16777236, 16515, 2564, 65576, 1539, 4194340, 1050625, 16644, 32835, 592, 8519680, 177, 2097410, 4232, 524312, 329, 4194323, 66562, 266241, 645, 8389633, 16777346, 2097165, 524323, 81921, 131112, 4456448, 32782, 8229, 16456, 65668, 2621440, 87, 1048600, 16777729, 1065, 550, 4355, 132098, 416, 1048611, 262212, 2073, 8328, 16842752, 4194562, 147457, 3076, 270337, 3145728, 20482, 8388644, 131204, 1104, 4194317, 528385, 262658, 32789, 2099201, 4144, 326, 8388627, 34818, 1157, 4718592, 16908288, 8451, 4612, 2312, 8650752, 1052673, 59, 16778241, 65603, 524356, 32899, 1062, 5242880, 656, 24578, 2097176, 527, 33028, 262184, 2070, 532481, 16421, 393, 8388866, 4196353, 8240, 2097187, 524802, 65550, 1048644, 131139, 8388621, 263170, 8708, 16520, 98305, 151, 1056769, 298, 2117, 1544, 278529, 16777252, 32840, 4121, 8912896, 1049090, 5124, 262276, 4194328, 16777235, 131086, 608, 2563, 524328, 163841, 4194339, 2101249, 1168, 16643, 65557, 9437184, 17039360, 1039, 36866, 92, 67586, 390, 6291456, 305, 8390657, 4360, 525314, 8217, 103, 1048616, 9220, 773, 540673, 16777474, 538, 131093, 2097220, 16432, 65667, 2089, 524420, 4118, 133122, 202, 65796, 1049602, 16777229, 2105345, 4198401, 16900, 262211, 40962, 1120, 8388632, 1064961, 2097666, 3075, 17301504, 32805, 585, 2128, 8456, 1048708, 8388643, 131203, 4165, 131332, 65608, 2181, 10485760, 262158, 32904, 4194372, 17825792, 8214, 294913, 209, 1285, 4611, 4202497, 1050, 672, 16779265, 2097192, 196609, 2086, 4194818, 16409, 524355, 69634, 131144, 17412, 114, 8392705, 8261, 33027, 156, 784, 2098178, 262165, 1097, 12582912, 582, 167, 2113537, 448, 264194, 1048643, 524302, 4137, 16777240, 49154, 8707, 135170, 2097284, 2568, 557057, 4194344, 8388676, 16777251, 16648, 32816, 6148, 279, 73730, 5123, 262275, 8396801, 1184, 18874368, 1048590, 4176, 65573, 33284, 262404, 649, 4195330, 2192, 108, 1081345, 8389122, 16406, 2063, 4229, 4210689, 524309, 8233, 1296, 65672, 91, 139266, 526338, 4194436, 1094, 327681, 554, 131109, 16781313, 10244, 262216, 16453, 4134, 9219, 3080, 1048597, 8272, 20971520, 2097219, 524419, 8388648, 1050626, 131208, 65795, 178, 32793, 524548, 8325, 393217, 2144, 16899, 330, 33796, 266242, 16777284, 1161, 646, 8389634, 561, 2097166, 81922, 1048707, 4616, 16785409, 8404993, 2129921, 589825, 8230, 1048836, 225, 131331, 65584, 16777730, 524360, 8388740, 1066, 4194371, 2309, 33032, 2074, 16425, 66052, 4240, 147458, 337, 4111, 1114113, 25165824, 270338, 172, 655361, 800, 1048648, 2097173, 18436, 262181, 4194318, 131120, 8712, 528386, 17411, 32790, 2099202, 155, 16464, 4227073, 2121, 12292, 16777256, 1158, 131588, 284, 1073, 5128, 1179649, 262280, 16517, 295, 1052674, 8336, 1541, 2097283, 32837, 16778242, 8207, 4192, 8388675, 2097412, 65561, 6147, 16793601, 4194325, 2208, 66564, 532482, 16422, 394, 4196354, 16777348, 33283, 524325, 262403, 1312, 107, 2162689, 9224, 777, 8388622, 2320, 704, 98306, 131097, 2097224, 1056770, 4357, 8421377, 2118, 524424, 278530, 132100, 4194435, 4122, 1048613, 65800, 8288, 786433, 16904, 4194564, 10243, 535, 262192, 401, 20484, 2228225, 32809, 199, 163842, 1048712, 262660, 2101250, 65558, 4169, 1310721, 8388629, 4259841, 524547, 34820, 131336, 16528, 2185, 33795, 306, 16399, 4194376, 8390658, 1552, 8453, 16777283, 32848, 8218, 1289};
constexpr array<u32, 101> VPF{0, 0, 1, 2, 1, 4, 3, 8, 1, 2, 5, 16, 3, 32, 9, 6, 1, 64, 3, 128, 5, 10, 17, 256, 3, 4, 33, 2, 9, 512, 7, 1024, 1, 18, 65, 12, 3, 2048, 129, 34, 5, 4096, 11, 8192, 17, 6, 257, 16384, 3, 8, 5, 66, 33, 32768, 3, 20, 9, 130, 513, 65536, 7, 131072, 1025, 10, 1, 36, 19, 262144, 65, 258, 13, 524288, 3, 1048576, 2049, 6, 129, 24, 35, 2097152, 5, 2, 4097, 4194304, 11, 68, 8193, 514, 17, 8388608, 7, 40, 257, 1026, 16385, 132, 3, 16777216, 9, 18, 5};

u16 n, N;

array<vector<u16>, 5000> G{};

constexpr array<array<u16, 25>, 5000> dp_init()
{
	array<array<u16, 25>, 5000> dp{};
	for (u16 i = 0; i < 5000; i++)
		for (u8 j = 0; j < 25; j++)
			dp[i][j] = BIG;
	return dp;
}
array<array<u16, 25>, 5000> DP = dp_init();
array<u8, 5000> V{}; // Value
array<u16, 5000> S{};  // Stack
array<u16, 5000> PO{}; // Post-order
array<u16, 5000> PA{}; // Parent
u16 ss = 1, po;

int main(int argc, const char* argv[])
{
	if (argc > 1)
	{
		ignore = freopen(argv[1], "r", stdin);
		ignore = freopen(argv[2], "w", stdout);
	}

	ios_base::sync_with_stdio(0);
	cin.tie(0);

	cin >> n;
	N = n * 2;

	u16 rd;
	for (u16 i = 0; i < n; i++)
	{
		cin >> rd;
		V[i] = (u8)rd;
	}
	for (u16 i = 1; i < n; i++)
	{
		u16 u, v;
		cin >> u >> v;
		--u; --v;
		G[u].push_back(v);
		G[v].push_back(u);
	}

	po = n;
	while (ss)
	{
		u16 v = S[--ss];
		PO[--po] = v;
		for (u16 w : G[v])
		{
			if (PA[v] == w)
				continue;
			PA[w] = v;
			S[ss++] = w;
		}
	}

	for (u16 v : PO)
	{
		u16 cv = 0, cw, bnd = 0;
		u32 vpf = VPF[V[v]], sfpf;
		for (u32 s = vpf; s; s &= s - 1)
			bnd = max(DP[v][__builtin_ctz(s)], bnd);
		for (u16 w : G[v])
		{
			cw = BIG;
			if (w == PA[v])
				continue;
			for (u32 s = vpf; s; s &= s - 1)
				cw = min(cw, DP[w][__builtin_ctz(s)]);
			if ((cv += cw) >= bnd)
				break;
		}
		if (cv < bnd)
			for (u32 s = vpf; s; s &= s - 1)
				DP[v][__builtin_ctz(s)] = min(DP[v][__builtin_ctz(s)], cv);
		for (u16 i = 0; i < NUM_SF; i++)
		{
			bnd = 0;
			sfpf = SFPF[i];
			for (u32 s = sfpf; s; s &= s - 1)
				bnd = max(DP[v][__builtin_ctz(s)], bnd);
			if (SF[i] >= bnd)
				continue;
			cv = SF[i];
			for (u16 w : G[v])
			{
				cw = BIG;
				if (w == PA[v])
					continue;
				for (u32 s = sfpf; s; s &= s - 1)
					cw = min(cw, DP[w][__builtin_ctz(s)]);
				if ((cv += cw) >= bnd)
					break;
			}
			if (cv < bnd)
				for (u32 s = sfpf; s; s &= s - 1)
					DP[v][__builtin_ctz(s)] = min(DP[v][__builtin_ctz(s)], cv);
		}
	}

	u16 ans = BIG;
	for (u8 i = 0; i < 25; i++)
		ans = min(ans, DP[0][i]);

	cout << ans;
}

/*
6
5
6
3
4
9
12
1 2
1 3
1 4
1 6
3 5

6
*/

/*
3
1
2
3
3 1
2 3

4
*/